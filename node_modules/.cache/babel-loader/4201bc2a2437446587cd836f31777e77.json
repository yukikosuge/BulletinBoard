{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kosugeyuki/Desktop/techpit-forum/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/kosugeyuki/Desktop/techpit-forum/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/kosugeyuki/Desktop/techpit-forum/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// ./src/helpers/useCreateThread.js\nimport{firestore}from'firebase/app';import{useState}from'react';export var useCreateThread=function useCreateThread(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var createResponse=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var text,title,username,now,threadRef,responseRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:text=_ref.text,title=_ref.title,username=_ref.username;if(!loading){_context.next=3;break;}return _context.abrupt(\"return\");case 3:setLoading(true);now=firestore.Timestamp.now();threadRef=firestore().collection('threads').doc();_context.next=8;return threadRef.set({createdAt:now,updatedAt:now,title:title,responseCount:1});case 8:responseRef=threadRef.collection('responses').doc();_context.next=11;return responseRef.set({createdAt:now,updatedAt:now,threadId:threadRef.id,username:username,text:text});case 11:setLoading(false);case 12:case\"end\":return _context.stop();}}},_callee);}));return function createResponse(_x){return _ref2.apply(this,arguments);};}();return[createResponse,loading];};","map":{"version":3,"sources":["/Users/kosugeyuki/Desktop/techpit-forum/src/helpers/useCreateThread.js"],"names":["firestore","useState","useCreateThread","loading","setLoading","createResponse","text","title","username","now","Timestamp","threadRef","collection","doc","set","createdAt","updatedAt","responseCount","responseRef","threadId","id"],"mappings":"2WAAA;AAEA,OAASA,SAAT,KAA0B,cAA1B,CACA,OAASC,QAAT,KAAyB,OAAzB,CAEA,MAAO,IAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,eACLD,QAAQ,CAAC,KAAD,CADH,wCAC5BE,OAD4B,eACnBC,UADmB,eAGnC,GAAMC,CAAAA,cAAc,2FAAG,yLAASC,IAAT,MAASA,IAAT,CAAeC,KAAf,MAAeA,KAAf,CAAsBC,QAAtB,MAAsBA,QAAtB,KACjBL,OADiB,iEAGrBC,UAAU,CAAC,IAAD,CAAV,CAEMK,GALe,CAKTT,SAAS,CAACU,SAAV,CAAoBD,GAApB,EALS,CAOfE,SAPe,CAOHX,SAAS,GAAGY,UAAZ,CAAuB,SAAvB,EAAkCC,GAAlC,EAPG,uBASfF,CAAAA,SAAS,CAACG,GAAV,CAAc,CAClBC,SAAS,CAAEN,GADO,CAElBO,SAAS,CAAEP,GAFO,CAGlBF,KAAK,CAALA,KAHkB,CAIlBU,aAAa,CAAE,CAJG,CAAd,CATe,QAgBfC,WAhBe,CAgBDP,SAAS,CAACC,UAAV,CAAqB,WAArB,EAAkCC,GAAlC,EAhBC,wBAkBfK,CAAAA,WAAW,CAACJ,GAAZ,CAAgB,CACpBC,SAAS,CAAEN,GADS,CAEpBO,SAAS,CAAEP,GAFS,CAGpBU,QAAQ,CAAER,SAAS,CAACS,EAHA,CAIpBZ,QAAQ,CAARA,QAJoB,CAKpBF,IAAI,CAAJA,IALoB,CAAhB,CAlBe,SA0BrBF,UAAU,CAAC,KAAD,CAAV,CA1BqB,uDAAH,kBAAdC,CAAAA,cAAc,6CAApB,CA6BA,MAAO,CAACA,cAAD,CAAiBF,OAAjB,CAAP,CACD,CAjCM","sourcesContent":["// ./src/helpers/useCreateThread.js\n\nimport { firestore } from 'firebase/app'\nimport { useState } from 'react'\n\nexport const useCreateThread = () => {\n  const [loading, setLoading] = useState(false)\n\n  const createResponse = async ({ text, title, username }) => {\n    if (loading) return\n\n    setLoading(true)\n\n    const now = firestore.Timestamp.now()\n\n    const threadRef = firestore().collection('threads').doc()\n\n    await threadRef.set({\n      createdAt: now,\n      updatedAt: now,\n      title,\n      responseCount: 1,\n    })\n\n    const responseRef = threadRef.collection('responses').doc()\n\n    await responseRef.set({\n      createdAt: now,\n      updatedAt: now,\n      threadId: threadRef.id,\n      username,\n      text,\n    })\n\n    setLoading(false)\n  }\n\n  return [createResponse, loading]\n}"]},"metadata":{},"sourceType":"module"}