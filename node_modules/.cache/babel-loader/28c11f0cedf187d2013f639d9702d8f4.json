{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kosugeyuki/Desktop/techpit-forum/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/kosugeyuki/Desktop/techpit-forum/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/kosugeyuki/Desktop/techpit-forum/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// ./src/helpers/useCreateThread.js\nimport{firestore}from'firebase/app';import{useState}from'react';export var useCreateResponse=function useCreateResponse(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var createResponse=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var text,threadId,username,now,threadRef,responseRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:text=_ref.text,threadId=_ref.threadId,username=_ref.username;if(!loading){_context.next=3;break;}return _context.abrupt(\"return\");case 3:setLoading(true);now=firestore.Timestamp.now();threadRef=firestore().collection('threads').doc(threadId);_context.next=8;return threadRef.update({responseCount:firestore.FieldValue.increment(1),updatedAt:now});case 8:responseRef=threadRef.collection('responses').doc();_context.next=11;return responseRef.set({createdAt:now,updatedAt:now,text:text,threadId:threadId,username:username});case 11:setLoading(false);case 12:case\"end\":return _context.stop();}}},_callee);}));return function createResponse(_x){return _ref2.apply(this,arguments);};}();return[createResponse,loading];};","map":{"version":3,"sources":["/Users/kosugeyuki/Desktop/techpit-forum/src/helpers/useCreateResponse.js"],"names":["firestore","useState","useCreateResponse","loading","setLoading","createResponse","text","threadId","username","now","Timestamp","threadRef","collection","doc","update","responseCount","FieldValue","increment","updatedAt","responseRef","set","createdAt"],"mappings":"2WAAA;AAEA,OAASA,SAAT,KAA0B,cAA1B,CACA,OAASC,QAAT,KAAyB,OAAzB,CAEA,MAAO,IAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,EAAM,eACPD,QAAQ,CAAC,KAAD,CADD,wCAC9BE,OAD8B,eACrBC,UADqB,eAGrC,GAAMC,CAAAA,cAAc,2FAAG,4LAASC,IAAT,MAASA,IAAT,CAAeC,QAAf,MAAeA,QAAf,CAAyBC,QAAzB,MAAyBA,QAAzB,KACjBL,OADiB,iEAGrBC,UAAU,CAAC,IAAD,CAAV,CAEMK,GALe,CAKTT,SAAS,CAACU,SAAV,CAAoBD,GAApB,EALS,CAOfE,SAPe,CAOHX,SAAS,GAAGY,UAAZ,CAAuB,SAAvB,EAAkCC,GAAlC,CAAsCN,QAAtC,CAPG,uBASfI,CAAAA,SAAS,CAACG,MAAV,CAAiB,CACrBC,aAAa,CAAEf,SAAS,CAACgB,UAAV,CAAqBC,SAArB,CAA+B,CAA/B,CADM,CAErBC,SAAS,CAAET,GAFU,CAAjB,CATe,QAcfU,WAde,CAcDR,SAAS,CAACC,UAAV,CAAqB,WAArB,EAAkCC,GAAlC,EAdC,wBAgBfM,CAAAA,WAAW,CAACC,GAAZ,CAAgB,CACpBC,SAAS,CAAEZ,GADS,CAEpBS,SAAS,CAAET,GAFS,CAGpBH,IAAI,CAAJA,IAHoB,CAIpBC,QAAQ,CAARA,QAJoB,CAKpBC,QAAQ,CAARA,QALoB,CAAhB,CAhBe,SAwBrBJ,UAAU,CAAC,KAAD,CAAV,CAxBqB,uDAAH,kBAAdC,CAAAA,cAAc,6CAApB,CA2BA,MAAO,CAACA,cAAD,CAAiBF,OAAjB,CAAP,CACD,CA/BM","sourcesContent":["// ./src/helpers/useCreateThread.js\n\nimport { firestore } from 'firebase/app'\nimport { useState } from 'react'\n\nexport const useCreateResponse = () => {\n  const [loading, setLoading] = useState(false)\n\n  const createResponse = async ({ text, threadId, username }) => {\n    if (loading) return\n\n    setLoading(true)\n\n    const now = firestore.Timestamp.now()\n\n    const threadRef = firestore().collection('threads').doc(threadId)\n\n    await threadRef.update({\n      responseCount: firestore.FieldValue.increment(1),\n      updatedAt: now,\n    })\n\n    const responseRef = threadRef.collection('responses').doc()\n\n    await responseRef.set({\n      createdAt: now,\n      updatedAt: now,\n      text,\n      threadId,\n      username,\n    })\n\n    setLoading(false)\n  }\n\n  return [createResponse, loading]\n}"]},"metadata":{},"sourceType":"module"}